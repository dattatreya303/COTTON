<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>COTTON: cotton-runtime.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">COTTON
   </div>
   <div id="projectbrief">COTTON: A light-weight work-stealing runtime for async-finish parallelism.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">cotton-runtime.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Header for COTTON runtime metohds.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="cotton_8h_source.html">cotton.h</a>&quot;</code><br />
</div>
<p><a href="cotton-runtime_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcotton_1_1Deque.html">cotton::Deque</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:af89f60b07247176687889ade776c8e10"><td class="memItemLeft" align="right" valign="top"><a id="af89f60b07247176687889ade776c8e10"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CACHE_LINE_SIZE</b>&#160;&#160;&#160;64</td></tr>
<tr class="separator:af89f60b07247176687889ade776c8e10"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad169fe95f5f03bdfa569dd365dde6c12"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cotton-runtime_8h.html#ad169fe95f5f03bdfa569dd365dde6c12">cotton::free_all</a> ()</td></tr>
<tr class="separator:ad169fe95f5f03bdfa569dd365dde6c12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ea9036584fa3bd86fe8626dc05d295f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cotton-runtime_8h.html#a4ea9036584fa3bd86fe8626dc05d295f">cotton::lib_key_init</a> ()</td></tr>
<tr class="separator:a4ea9036584fa3bd86fe8626dc05d295f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1ebe1f6821a54e7c4911c22acebff8a"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cotton-runtime_8h.html#ab1ebe1f6821a54e7c4911c22acebff8a">cotton::get_threadID</a> ()</td></tr>
<tr class="separator:ab1ebe1f6821a54e7c4911c22acebff8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af22caee9434a7e06a09b2f9a0417c1eb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cotton-runtime_8h.html#af22caee9434a7e06a09b2f9a0417c1eb">cotton::find_and_execute_task</a> ()</td></tr>
<tr class="separator:af22caee9434a7e06a09b2f9a0417c1eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cae25b77bd884fcdcf2532663056d22"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cotton-runtime_8h.html#a1cae25b77bd884fcdcf2532663056d22">cotton::grab_task_from_runtime</a> ()</td></tr>
<tr class="separator:a1cae25b77bd884fcdcf2532663056d22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b32dd3b6a3d126e107d5c77ec1f4cc3"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cotton-runtime_8h.html#a0b32dd3b6a3d126e107d5c77ec1f4cc3">cotton::thread_pool_size</a> ()</td></tr>
<tr class="separator:a0b32dd3b6a3d126e107d5c77ec1f4cc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a361c34063ecb68cf02d417074decb12b"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cotton-runtime_8h.html#a361c34063ecb68cf02d417074decb12b">cotton::worker_routine</a> (void *args)</td></tr>
<tr class="separator:a361c34063ecb68cf02d417074decb12b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a803285410d295a5f32238ad2dfc241a5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cotton-runtime_8h.html#a803285410d295a5f32238ad2dfc241a5">cotton::push_task_to_runtime</a> (void *task)</td></tr>
<tr class="separator:a803285410d295a5f32238ad2dfc241a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad72043de8ba79ff3385abd67fd1b15bf"><td class="memItemLeft" align="right" valign="top"><a id="ad72043de8ba79ff3385abd67fd1b15bf"></a>
volatile bool&#160;</td><td class="memItemRight" valign="bottom"><b>cotton::SHUTDOWN</b></td></tr>
<tr class="separator:ad72043de8ba79ff3385abd67fd1b15bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1c243496d4cac35fb6d8fb6be14b0f3"><td class="memItemLeft" align="right" valign="top"><a id="ae1c243496d4cac35fb6d8fb6be14b0f3"></a>
pthread_t *&#160;</td><td class="memItemRight" valign="bottom"><b>cotton::thread</b> = NULL</td></tr>
<tr class="separator:ae1c243496d4cac35fb6d8fb6be14b0f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41bafde742c3ac2e3f360be9a8b2926d"><td class="memItemLeft" align="right" valign="top"><a id="a41bafde742c3ac2e3f360be9a8b2926d"></a>
pthread_key_t&#160;</td><td class="memItemRight" valign="bottom"><b>cotton::THREAD_KEY</b></td></tr>
<tr class="separator:a41bafde742c3ac2e3f360be9a8b2926d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d692d5b7c9fbd1d4999ed8270ebcce0"><td class="memItemLeft" align="right" valign="top"><a id="a0d692d5b7c9fbd1d4999ed8270ebcce0"></a>
unsigned int&#160;</td><td class="memItemRight" valign="bottom"><b>cotton::NUM_WORKERS</b> = 0</td></tr>
<tr class="separator:a0d692d5b7c9fbd1d4999ed8270ebcce0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71daeb136715fb167bda82ac84373091"><td class="memItemLeft" align="right" valign="top"><a id="a71daeb136715fb167bda82ac84373091"></a>
pthread_mutex_t *&#160;</td><td class="memItemRight" valign="bottom"><b>cotton::DEQUE_MUTEX</b> = NULL</td></tr>
<tr class="separator:a71daeb136715fb167bda82ac84373091"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c3fa2e0febd6194c6c2e1b8274e3b6a"><td class="memItemLeft" align="right" valign="top"><a id="a8c3fa2e0febd6194c6c2e1b8274e3b6a"></a>
volatile unsigned int&#160;</td><td class="memItemRight" valign="bottom"><b>cotton::FINISH_COUNTER</b></td></tr>
<tr class="separator:a8c3fa2e0febd6194c6c2e1b8274e3b6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc469e68d18d644b538f6f16335fb5c4"><td class="memItemLeft" align="right" valign="top"><a id="abc469e68d18d644b538f6f16335fb5c4"></a>
const unsigned int&#160;</td><td class="memItemRight" valign="bottom"><b>cotton::MAX_DEQUE_SIZE</b> = 100</td></tr>
<tr class="separator:abc469e68d18d644b538f6f16335fb5c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a261cb084089447eb9c2bab5c95891795"><td class="memItemLeft" align="right" valign="top"><a id="a261cb084089447eb9c2bab5c95891795"></a>
const unsigned int&#160;</td><td class="memItemRight" valign="bottom"><b>cotton::DEFAULT_NUM_WORKERS</b> = 1</td></tr>
<tr class="separator:a261cb084089447eb9c2bab5c95891795"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49aaf0b0bc093f68bcc20907ff338827"><td class="memItemLeft" align="right" valign="top"><a id="a49aaf0b0bc093f68bcc20907ff338827"></a>
pthread_once_t&#160;</td><td class="memItemRight" valign="bottom"><b>cotton::THREAD_KEY_ONCE</b> = PTHREAD_ONCE_INIT</td></tr>
<tr class="separator:a49aaf0b0bc093f68bcc20907ff338827"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fa66e316877ba57e881d9c4fd193765"><td class="memItemLeft" align="right" valign="top"><a id="a0fa66e316877ba57e881d9c4fd193765"></a>
pthread_mutex_t&#160;</td><td class="memItemRight" valign="bottom"><b>cotton::FINISH_MUTEX</b> = PTHREAD_MUTEX_INITIALIZER</td></tr>
<tr class="separator:a0fa66e316877ba57e881d9c4fd193765"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17e2506c45982338f909158a75592bd6"><td class="memItemLeft" align="right" valign="top"><a id="a17e2506c45982338f909158a75592bd6"></a>
Deque *&#160;</td><td class="memItemRight" valign="bottom"><b>cotton::DEQUE_ARRAY</b> = NULL</td></tr>
<tr class="separator:a17e2506c45982338f909158a75592bd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header for COTTON runtime metohds. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="file_af22caee9434a7e06a09b2f9a0417c1eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_af22caee9434a7e06a09b2f9a0417c1eb">&#9670;&nbsp;</a></span>find_and_execute_task()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cotton::find_and_execute_task </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Finds a task from the per thread deque data structures, executes it and finally decrements the volatile finish counter after acquiring the lock</p>
<dl class="section return"><dt>Returns</dt><dd>Void </dd></dl>

</div>
</div>
<a id="file_ad169fe95f5f03bdfa569dd365dde6c12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_ad169fe95f5f03bdfa569dd365dde6c12">&#9670;&nbsp;</a></span>free_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cotton::free_all </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Call free() on everything allocated on heap.</p>
<dl class="section return"><dt>Returns</dt><dd>Void </dd></dl>

</div>
</div>
<a id="file_ab1ebe1f6821a54e7c4911c22acebff8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_ab1ebe1f6821a54e7c4911c22acebff8a">&#9670;&nbsp;</a></span>get_threadID()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int cotton::get_threadID </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gives the calling thread's ID used to access the per thread deque data structure</p>
<dl class="section return"><dt>Returns</dt><dd>Thread ID of the calling thread </dd></dl>

</div>
</div>
<a id="file_a1cae25b77bd884fcdcf2532663056d22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_a1cae25b77bd884fcdcf2532663056d22">&#9670;&nbsp;</a></span>grab_task_from_runtime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * cotton::grab_task_from_runtime </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Pops or steals a task encapsulated as a lambda function from the caller or the victim thread's deque data structure.</p>
<p>It first checks in the calling thread deque data structure and if if does not find any then it tries to steal for other threads' deque data structure. All this is done after taking the necessary locks to avoid data races</p>
<dl class="section return"><dt>Returns</dt><dd>Task encapsulated in a lambda function </dd></dl>

</div>
</div>
<a id="file_a4ea9036584fa3bd86fe8626dc05d295f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_a4ea9036584fa3bd86fe8626dc05d295f">&#9670;&nbsp;</a></span>lib_key_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cotton::lib_key_init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Wrapper to initialize the value of the pthread key variable with proper error checking</p>
<dl class="section return"><dt>Returns</dt><dd>Void </dd></dl>

</div>
</div>
<a id="file_a803285410d295a5f32238ad2dfc241a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_a803285410d295a5f32238ad2dfc241a5">&#9670;&nbsp;</a></span>push_task_to_runtime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cotton::push_task_to_runtime </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>task</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Pushes a task encapsulated in a lambda function into the calling thread's data structure</p>
<dl class="section return"><dt>Returns</dt><dd>Void </dd></dl>

</div>
</div>
<a id="file_a0b32dd3b6a3d126e107d5c77ec1f4cc3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_a0b32dd3b6a3d126e107d5c77ec1f4cc3">&#9670;&nbsp;</a></span>thread_pool_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int cotton::thread_pool_size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Wrapper to get the value mentioned in the environment variable COTTON_WORKERS</p>
<dl class="section return"><dt>Returns</dt><dd>Number of threads to use at max (default = 1) </dd></dl>

</div>
</div>
<a id="file_a361c34063ecb68cf02d417074decb12b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_a361c34063ecb68cf02d417074decb12b">&#9670;&nbsp;</a></span>worker_routine()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * cotton::worker_routine </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>args</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Encapsulates the work that a thread does once spawing which includes setting the per thread ID and spinning until the thread finds a task to execute</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">args</td><td>Contains the argument related to the ID of the calling thread </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Void </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
